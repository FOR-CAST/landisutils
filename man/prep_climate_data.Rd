% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/climate_data.R
\name{prep_daily_weather}
\alias{prep_daily_weather}
\alias{prep_monthly_weather}
\title{Prepare Climate Data}
\usage{
prep_daily_weather(
  var = NULL,
  studyArea = NULL,
  id = NULL,
  start = NULL,
  end = NULL
)

prep_monthly_weather(
  var = NULL,
  studyArea = NULL,
  id = NULL,
  start = NULL,
  end = NULL
)
}
\arguments{
\item{var}{character specifying the climate variable.}

\item{studyArea}{\code{sf} polygons object delineating e.g., ecoregions or fire zones.}

\item{id}{character specifying the name of the column/field to use for zonal summaries.}

\item{start, end}{character specifying the start and end dates as \code{"YYYY-M-DD"}.}
}
\value{
\code{tbl_df}
}
\description{
Download and prepare climate data for use with LANDIS-II simulations:
}
\details{
\enumerate{
\item Climate data for the \code{studyArea} are downloaded and converted to \code{SpatRaster}
using the \pkg{climateR} package;
\item These are then summarized by zone (specified by \code{id}) using the \pkg{zonal} package;
\item The tabular data are pivoted as required for ingestion by LANDIS-II Climate Library.
}
}
\section{Historical daily weather}{

Daymet provides daily North American weather 1980-present (\url{https://daymet.ornl.gov/}).
Daymet variables: \code{dayl}, \code{prcp}, \code{srad}, \code{swe}, \code{tmax}, \code{tmin}, \code{vp}.
Use \code{\link[=prep_daily_weather]{prep_daily_weather()}} for Daymet weather data.
}

\section{Climate projections}{

TODO
}

\examples{
## define study area
## use BEC zones in random study area in BC
studyAreaBC <- terra::vect(cbind(-122.14, 52.14), crs = "epsg:4326") |>
  terra::project(paste("+proj=lcc +lat_1=49 +lat_2=77 +lat_0=0 +lon_0=-95",
    "+x_0=0 +y_0=0 +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0")) |>
  SpaDES.tools::randomStudyArea(seed = 60, size = 1e10)

## we can safely ignore the following warnings:
## "attribute variables are assumed to be spatially constant throughout all geometries"
ecoregionPolys <- suppressWarnings({
  scfmutils::prepInputsFireRegimePolys(studyArea = studyAreaBC, type = "BECNDT")
})

if (interactive()) plot(frpFRT["PolyID"])

clim_years <- 2011:2012 ## availability is 1980 to last year

## get historic daily weather data from Daymet
daily_climvars <- c("prcp", "tmax", "tmin")
daily_weather <- purrr::map(
  .x = clim_vars,
  .f = prep_daily_weather,
  studyArea = ecoregionPolys,
  id = "PolyID",
  start = glue::glue("{head(clim_years, 1)}-01-01"),
  end = glue::glue("{tail(clim_years, 1)}-12-31")
) |>
  purrr::list_rbind()

head(daily_weather)

## get historic monthly weather from TerraClim
monthly_climvars <- c("ppt", "tmax", "tmin")
monthly_weather <- purrr::map(
  .x = climvars,
  .f = prep_monthly_weather,
  studyArea = ecoregionPolys,
  id = "PolyID",
  start = glue::glue("{head(clim_years, 1)}-01-01"),
  end = glue::glue("{tail(clim_years, 1)}-12-31")
) |>
  purrr::list_rbind() |>
  dplyr::filter(Year <= tail(clim_years, 1)) ## match end year

head(monthly_weather)

}
